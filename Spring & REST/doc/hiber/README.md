## Hibernate [[0.33]](https://docs.jboss.org/hibernate/core/3.3/reference/en/html/objectstate.html#objectstate-overview) [[0.43]](https://docs.jboss.org/hibernate/core/4.3/manual/en-US/html/)
### Hibernate Proxy
Hibernate generates uninitialized proxy using CGlib. [[1]](https://www.baeldung.com/hibernate-proxy-load-method) 

 Something like that: 
```java
public class HibernateProxy extends MyEntity {
    private MyEntity target;
 
    public String getFirstName() {
        if (target == null) {
            target = readFromDatabase();
        }
        return target.getFirstName();
    }
}
```
`OneToMany` and `ManyToOne` will be loaded depending on the fetching strategy.
 
 [another good link](https://vladmihalcea.com/how-does-a-jpa-proxy-work-and-how-to-unproxy-it-with-hibernate/)
 
### [entity lifecycle diagram](./entity-lifecycle.puml) [[2]](https://vladmihalcea.com/a-beginners-guide-to-jpa-hibernate-entity-state-transitions/) [[3]](https://dzone.com/articles/jpa-entity-lifecycle) [[3]](https://www.baeldung.com/hibernate-entity-lifecycle)

### Identity Generation [[thoughts-on-java.org]](https://thoughts-on-java.org/jpa-generate-primary-keys/)

`@Id` can be applied to Java primitive and primitive wrapper types, String, Date, BigDecimal, BigInteger.

`@GeneratedValue` types :

* `AUTO` (default one) - Allows persistence provider to choose which one to use. In case of Hibernate also depends on database dialect, more likely `SEQUENCE` will be selected.
* `IDENTITY` - Relay on database autogenerated column value. In case of hibernate requires an immediate insert and disables some optimisations.
* `SEQUENCE` - Relay on DB sequence. If no additional parameters specified default hibernate sequence will be used. (`@SequenceGenerator` + `@GeneratedValue` can change this)
* `TABLE` - Seems like this one for thous of us hows life is full of pain and databases not support sequences. It looks like uniqueness of id guarantied by some utils table in the database.
All these generators requires database connection.
[[baeldung.com]](https://www.baeldung.com/hibernate-identifiers)

By using `@GenericGenerator` and implementing IdentifierGenerator we can build or own strategy.

`@EmbeddedId` or `@IdClass` allows composite keys.      